{
  "id": "./docs/en/releases/v7.md",
  "content": "---\ncreatedAt: 2025-09-22\nupdatedAt: 2025-09-23\ntitle: New Intlayer v7 - What's new?\ndescription: Discover what's new in Intlayer v7. Major improvements in performance, developer experience, and new features to enhance your internationalization workflow.\nkeywords:\n  - Intlayer\n  - Localization\n  - Development\n  - Performance\n  - Developer Experience\n  - Features\n  - React\n  - Next.js\n  - JavaScript\n  - TypeScript\nslugs:\n  - doc\n  - releases\n  - v7\n---\n\n# New Intlayer v7 - What's new?\n\nWelcome to Intlayer v7! This major release introduces significant improvements in performance, type safety, and developer experience. Below are the highlights, with migration notes and practical examples.\n\n## Table of contents\n\n<TOC levels={[2]} maxDepth={1} />\n\n## Highlights\n\n- Next.js 16 support\n- Caching strategy for faster builds\n- Improved TypeScript type generation with locale-specific types\n- Bundle optimization: Locales as strings instead of enum\n- New routing modes: `prefix-no-default`, `prefix-all`, `no-prefix`, `search-params`\n- GDPR-compliant using localStorage\n- Flexible storage configuration: cookies, localStorage, sessionStorage, or multiple\n- 30% smaller Visual Editor package size\n- Enhanced middleware configuration options\n- Updated fill command behavior for better content management\n- New dictionary configuration section for better organization\n- Enhanced stability with complete content declaration file updates\n- Intelligent retry management for translation accuracy\n- Parallelization for faster translation processing\n- Smart chunking to handle large files within AI context limits\n- Automatic code formatting with configurable formatCommand\n\n---\n\n## Performance: Caching for faster builds\n\nInstead of rebuilding content declarations with esbuild on every build, v7 implements a caching strategy that speeds up the build process.\n\n```bash\nnpx intlayer build\n```\n\nThe new caching system:\n\n- Stores compiled content declarations to avoid redundant processing\n- Detects changes and rebuilds only modified files\n- Significantly reduces build times for large projects\n\n---\n\n## TypeScript: Locale-specific type generation\n\nTypeScript types are now generated per locale, providing stronger typing and eliminating union types across all locales.\n\n**v6 behavior:**\n\n```tsx\nconst content = getIntlayer(\"my-title-content\", \"en\");\n// typeof content = { title: \"My title\" } | { title: \"Mon titre\" } | { title: \"Mi tÃ­tulo\" }\n```\n\n**v7 behavior:**\n\n```tsx\nconst content = getIntlayer(\"my-title-content\", \"en\");\n// typeof content = { title: \"My title\" }\n```\n\nBenefits:\n\n- More precise autocomplete in your IDE\n- Better type safety with no cross-locale type pollution\n- Improved performance by reducing type complexity\n\n---\n\n## Bundle optimization: Locales as strings\n\nThe `Locales` type is no longer an enum, which means it's now fully tree-shakeable and won't bloat your bundle with thousands of unused locale records.\n\n**v6:**\n\n```typescript\nimport { Locales } from \"intlayer\";\n// Enum including all locales -> not tree-shakeable\n\nconst locale: Locales = Locales.ENGLISH;\n```\n\n**v7:**\n\n```typescript\nimport { Locales, Locale } from \"intlayer\";\n// String type -> fully tree-shakeable\n\nconst locale: Locale = Locales.ENGLISH;\n```\n\n> Because `Locales` is not an enum anymore, you will have to change the type from `Locales` to `Locale` to get the locale as a type.\n\nSee the [implementation details](https://github.com/aymericzip/intlayer/blob/main/packages/%40intlayer/types/src/index.ts) for more information.\n\n---\n\n## New routing modes for greater flexibility\n\nv7 introduces a unified `routing.mode` configuration that replaces the previous `prefixDefault` and `noPrefix` options, offering more granular control over URL structure.\n\n### Available routing modes\n\n- **`prefix-no-default`** (default): Default locale has no prefix, other locales do\n  - `/dashboard` (en) or `/fr/dashboard` (fr)\n- **`prefix-all`**: All locales have a prefix\n  - `/en/dashboard` (en) or `/fr/dashboard` (fr)\n- **`no-prefix`**: No locale prefixes in URLs (locale handled via storage/headers)\n  - `/dashboard` for all locales\n- **`search-params`**: Locale passed as a query parameter\n  - `/dashboard?locale=en` or `/dashboard?locale=fr`\n\n### Basic configuration\n\n```typescript\n// intlayer.config.ts\nexport default {\n  internationalization: {\n    locales: [\"en\", \"fr\", \"es\"],\n    defaultLocale: \"en\",\n  },\n  routing: {\n    mode: \"prefix-no-default\", // default\n  },\n};\n```\n\n---\n\n## GDPR compliance: localStorage / cookies storage\n\nv7 prioritizes user privacy by using `localStorage` as the default storage mechanism instead of cookies. This change helps with GDPR compliance by avoiding cookie consent requirements for locale preferences.\n\n### Storage configuration options\n\nThe new `routing.storage` field is also available in addition to the previous `middleware.cookieName` and `middleware.serverSetCookie` options, offering flexible storage configurations:\n\n```typescript\n// Disable storage\nstorage: false\n\n// Simple storage types\nstorage: 'cookie'\nstorage: 'localStorage'\nstorage: 'sessionStorage'\n\n// Cookie with custom attributes\nstorage: {\n  type: 'cookie',\n  name: 'custom-locale',\n  domain: '.example.com',\n  secure: true,\n  sameSite: 'strict'\n}\n\n// localStorage with custom key\nstorage: {\n  type: 'localStorage',\n  name: 'custom-locale'\n}\n\n// Multiple storage types for redundancy\nstorage: ['cookie', 'localStorage']\n```\n\n### GDPR-compliant configuration example\n\nFor production applications that need to balance functionality with GDPR compliance:\n\n```typescript fileName=\"intlayer.config.ts\"\nexport default {\n  internationalization: {\n    locales: [\"en\", \"fr\", \"es\"],\n    defaultLocale: \"en\",\n  },\n  routing: {\n    mode: \"prefix-no-default\",\n    storage: [\n      {\n        type: \"localStorage\", // Primary storage (no consent needed)\n        name: \"user-locale\",\n      },\n      {\n        type: \"cookie\", // Optional cookie storage (requires consent)\n        name: \"user-locale\",\n        secure: true,\n        sameSite: \"strict\",\n        httpOnly: false,\n      },\n    ],\n  },\n};\n```\n\n### Enable / disable the cookie storage\n\nExample using React / Next.js:\n\nCan be defined globally:\n\n```typescript\n<IntlayerProvider isCookieEnabled={false}>\n  <App />\n</IntlayerProvider>\n```\n\nCan override it locally for each hook:\n\n```ts\nconst { setLocale } = useLocale({ isCookieEnabled: false });\n\nsetLocale(\"en\");\n```\n\n**Note:** Cookies is enabled by default.\n**Note:** Check [GDPR cookie requirements](https://gdpr.eu/cookies/) for your specific use case.\n\n---\n\n## Visual Editor: 30% smaller package\n\nThe Visual Editor package has been optimized to be 30% smaller than the previous version, thanks to:\n\n- Code editor performance improvements\n- Removal of unnecessary dependencies on Intlayer core packages\n- Better tree-shaking and module bundling\n\nThis results in faster download times and improved runtime performance for your application.\n\n---\n\n## Automatic Code Formatting: formatCommand configuration\n\nv7 introduces the `formatCommand` option in the editor configuration, allowing you to automatically format content files when they are written by Intlayer. This ensures consistent code style and formatting across your content declaration files.\n\nIf not set, Intlayer will try to detect the format command automatically. By trying to resolve the following commands: prettier, biome, eslint.\n\n### Configuration\n\nThe `formatCommand` option accepts a string template where `{{file}}` will be replaced with the actual file path:\n\n```typescript fileName=\"intlayer.config.ts\"\nexport default {\n  content: {\n    formatCommand: 'bun x biome format \"{{file}}\" --write --log-level none',\n  },\n};\n```\n\n### Supported formatters\n\nYou can use any code formatter that accepts file paths as arguments:\n\n**Using Biome:**\n\n```typescript\nformatCommand: 'bun x biome format \"{{file}}\" --write --log-level none';\n```\n\n**Using Prettier:**\n\n```typescript\nformatCommand: 'npx prettier --write \"{{file}}\" --log-level silent';\n```\n\n**Using ESLint:**\n\n```typescript\nformatCommand: 'npx eslint --fix \"{{file}}\" --quiet';\n```\n\n**Using Bun's built-in formatter:**\n\n```typescript\nformatCommand: 'bun format \"{{file}}\"';\n```\n\n### Benefits\n\n- **Consistent formatting**: All content files are automatically formatted according to your project's style guidelines\n- **Developer experience**: No need to manually format files after Intlayer writes them\n- **Team consistency**: Ensures all team members have the same formatting applied to content files\n- **CI/CD integration**: Content files maintain consistent formatting in automated workflows\n\n### How it works\n\nWhen Intlayer writes or updates a content declaration file (`.content.ts`, `.content.js`, etc.), it automatically runs the specified format command on the file. The `{{file}}` placeholder is replaced with the actual file path, and the command is executed in the project's base directory.\n\n---\n\n## Dictionary Configuration: Better organization and structure\n\nv7 introduces a new dedicated `dictionary` configuration section that provides better organization for dictionary-related settings and improved content management.\n\n### New dictionary configuration structure\n\nThe `fill` property has been moved from the `content` section to a new `dictionary` section, providing clearer separation of concerns:\n\n**v6 configuration:**\n\n```typescript fileName=\"intlayer.config.ts\"\nexport default {\n  content: {\n    autoFill: \"./{{fileName}}.content.json\",\n    contentDir: [\"src\"],\n  },\n};\n```\n\n**v7 configuration:**\n\n```typescript fileName=\"intlayer.config.ts\"\nexport default {\n  content: {\n    contentDir: [\"src\"],\n  },\n  dictionary: {\n    fill: \"./{{fileName}}.content.json\",\n  },\n};\n```\n\n### Benefits of the new structure\n\n- **Clearer organization**: Dictionary-specific settings are now grouped together\n- **Better separation of concerns**: Content discovery vs. dictionary operations are clearly separated\n- **Enhanced maintainability**: Easier to understand and modify dictionary-related configurations\n- **Future extensibility**: The dictionary section can accommodate additional dictionary-specific settings\n- **Comprehensive dictionary management**: Includes properties like `title`, `live`, `priority`, `tags`, `version`, and `description` for creating and managing new dictionaries\n\n### Configuration usage\n\nThe dictionary configuration serves two main purposes:\n\n1. **Default Values**: Define default values when creating content declaration files\n2. **Fallback Behavior**: Provide fallback values when specific fields are not defined, allowing you to define dictionary operation behavior globally\n\nThe dictionary section includes comprehensive properties for dictionary management:\n\n- **`fill`**: Auto-fill behavior for content generation\n- **`title`**: Default title for new dictionaries\n- **`live`**: Live sync configuration for real-time updates\n- **`priority`**: Priority settings for dictionary resolution\n- **`tags`**: Default tags for content organization\n- **`version`**: Version management for dictionary updates\n- **`description`**: Default description for new content\n\nFor more information about content declaration files and how configuration values are applied, see the [Content File Documentation](https://github.com/aymericzip/intlayer/blob/main/docs/docs/en/dictionary/content_file.md).\n\n---\n\n## Fill command: Updated behavior for better content management\n\nv7 introduces improved behavior for the `fill` command, providing more predictable and flexible content management:\n\n### New fill behavior\n\n- **`fill: true`** - Rewrites the current file with filled content for all locales\n- **`fill: \"path/to/file\"`** - Fills the specified file without modifying the current file\n- **`fill: false`** - Disables auto-fill completely\n\n### Enhanced support for complex content structures\n\nThe fill command now supports complex content declaration structures, including:\n\n- **Composed objects**: Content declarations that reference other objects\n- **Destructured content**: Content that uses destructuring patterns\n- **Nested references**: Objects that call each other in complex hierarchies\n- **Dynamic content structures**: Content with conditional or computed properties\n\n### Benefits\n\n- **Clearer intent**: The behavior is now more explicit about what gets modified\n- **Better separation**: Content files can be kept separate from filled translations\n- **Improved workflow**: Developers have more control over where translations are stored\n- **Complex structure support**: Handle sophisticated content architectures with multiple interconnected objects\n\n### Example usage\n\n```typescript fileName=\"*.content.ts\"\n// Rewrite current file with all locales\nconst content = {\n  key: \"example\",\n  fill: true, // Rewrites this file\n  content: {\n    title: \"Hello World\",\n  },\n};\n\n// Fill separate file without modifying current file\nconst content = {\n  key: \"example\",\n  fill: \"./translations.json\", // Creates/updates translations.json\n  content: {\n    title: \"Hello World\",\n  },\n};\n\n// Disable auto-fill\nconst content = {\n  key: \"example\",\n  fill: false, // No auto-fill\n  content: {\n    title: \"Hello World\",\n  },\n};\n\n// Complex content structure with composed objects\nconst sharedContent = {\n  buttons: {\n    save: \"Save\",\n    cancel: \"Cancel\",\n  },\n};\n\nconst content = {\n  key: \"complex-example\",\n  fill: true,\n  content: {\n    // References to other objects\n    sharedContent,\n\n    // Destructured content\n    ...sharedContent,\n\n    // Nested references\n    sections: [\n      {\n        ...sharedContent.buttons,\n        header: \"Section 1\",\n      },\n    ],\n  },\n};\n```\n\n---\n\n## Enhanced stability and translation management\n\nv7 introduces several improvements to make content translation more reliable and efficient:\n\n### Complete content declaration file updates\n\nThe system now updates `.content.{ts,js,cjs,mjs}` files rather than partial updates, ensuring:\n\n- **Data integrity**: Complete file rewrites prevent partial updates that could corrupt content\n- **Consistency**: All locales are updated atomically, maintaining synchronization\n- **Reliability**: Reduces the risk of incomplete or malformed content files\n\n### Intelligent retry management\n\nNew retry mechanisms prevent pushing content in incorrect formats, and avoid breaking the whole fill process if one request fails.\n\n### Parallelization for faster processing\n\nTranslation operations now run in a queue to run them in parallel. This significantly speeds up the process.\n\n### Smart chunking for large files\n\nAdvanced chunking strategies handle large content files without exceeding AI context windows:\n\n### Example workflow\n\n```typescript fileName=\"*.content.ts\"\n// Large content file gets automatically chunked\nconst content = {\n  key: \"large-documentation\",\n  fill: true,\n  content: {\n    // Large content automatically chunked for AI processing\n    introduction: \"...\" // 5000+ characters\n    sections: [\n      // Multiple large sections\n    ]\n  }\n};\n```\n\nThe system automatically:\n\n1. Analyzes content size and structure\n2. Chunks content appropriately\n3. Processes chunks in parallel\n4. Validates and retries if needed\n5. Reconstructs the complete file\n\n---\n\n## Migration notes from v6\n\n### Removed configurations\n\n- **`middleware.cookieName`**: Replaced by `routing.storage`\n- **`middleware.serverSetCookie`**: Replaced by `routing.storage`\n- **`middleware.prefixDefault`**: Replaced by `routing.mode`\n- **`middleware.noPrefix`**: Replaced by `routing.mode`\n\n### New configurations\n\n- **`editor.formatCommand`**: New option for automatic code formatting of content files\n\n### Migration mapping\n\n#### Configuration mapping\n\n| v6 Configuration           | v7 Configuration                                     |\n| -------------------------- | ---------------------------------------------------- |\n| `content.autoFill: xxx`    | `dictionary.fill: xxx`                               |\n| `prefixDefault: false`     | `mode: 'prefix-no-default'`                          |\n| `prefixDefault: true`      | `mode: 'prefix-all'`                                 |\n| `noPrefix: true`           | `mode: 'no-prefix'`                                  |\n| `cookieName: 'my-locale'`  | `storage: { type: 'cookie', name: 'my-locale' }`     |\n| `serverSetCookie: 'never'` | `storage: false` or remove cookie from storage array |\n\n#### Example migration\n\n**Before (v6):**\n\n```typescript fileName=\"intlayer.config.ts\"\nexport default {\n  content: {\n    autoFill: \"./{{fileName}}.content.json\",\n    contentDir: [\"src\"],\n  },\n  middleware: {\n    headerName: \"x-intlayer-locale\",\n    cookieName: \"intlayer-locale\",\n    prefixDefault: false,\n    basePath: \"\",\n    serverSetCookie: \"always\",\n    noPrefix: false,\n  },\n};\n```\n\n**After (v7):**\n\n```typescript fileName=\"intlayer.config.ts\"\nexport default {\n  content: {\n    contentDir: [\"src\"],\n  },\n  dictionary: {\n    fill: \"./{{fileName}}.content.json\",\n  },\n  routing: {\n    mode: \"prefix-no-default\",\n    storage: \"localStorage\", // or 'cookie' if you need cookie storage\n    headerName: \"x-intlayer-locale\",\n    basePath: \"\",\n  },\n  editor: {\n    formatCommand: 'bun x biome format \"{{file}}\" --write --log-level none', // Optional: automatic formatting\n  },\n};\n```\n\n#### Dictionary content mapping\n\n| v6 Dictionary content | v7 Dictionary content |\n| --------------------- | --------------------- |\n| `autoFill: xxx`       | `fill: xxx`           |\n\n#### Example migration\n\n**Before (v6):**\n\n```typescript fileName=\"*.content.ts\"\nconst content = {\n  key: \"example\",\n  autoFill: true, // Rewrites this file\n  content: {\n    title: \"Hello World\",\n  },\n};\n```\n\n**After (v7):**\n\n```typescript fileName=\"*.content.ts\"\nconst content = {\n  key: \"example\",\n  fill: true, // Rewrites this file\n  content: {\n    title: \"Hello World\",\n  },\n};\n```\n\n---\n\n## Migration notes from v5 to v6\n\nCheck the [migration notes from v5 to v6](https://github.com/aymericzip/intlayer/blob/main/docs/docs/en/releases/v6.md) for more information.\n\n---\n\n## Useful links\n\n- [Configuration Reference](https://github.com/aymericzip/intlayer/blob/main/docs/docs/en/configuration.md)\n- [Middleware Documentation](https://github.com/aymericzip/intlayer/blob/main/docs/docs/en/packages/next-intlayer/index.md)\n- [TypeScript Types](https://github.com/aymericzip/intlayer/blob/main/packages/%40intlayer/types/src/index.ts)\n- [GDPR Cookie Guidelines](https://gdpr.eu/cookies/)\n",
  "createdAt": "2025-09-22",
  "updatedAt": "2025-09-23",
  "title": "New Intlayer v7 - What's new?",
  "description": "Discover what's new in Intlayer v7. Major improvements in performance, developer experience, and new features to enhance your internationalization workflow.",
  "keywords": [
    "Intlayer",
    "Localization",
    "Development",
    "Performance",
    "Developer Experience",
    "Features",
    "React",
    "Next.js",
    "JavaScript",
    "TypeScript"
  ],
  "slugs": [
    "doc",
    "releases",
    "v7"
  ],
  "docKey": "./docs/en/releases/v7.md",
  "githubUrl": "https://github.com/aymericzip/intlayer/blob/main/docs/docs/en/releases/v7.md",
  "relativeUrl": "/doc/releases/v7",
  "url": "https://intlayer.org/doc/releases/v7"
}